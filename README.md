# EasyFFmpeg #

指定した動画ファイルを**FFmpeg**を使用して他の動画形式に変換する簡易のフロントエンドアプリケーションです。  

## バージョン ##

2.1.0

## ライセンス ##

本ソフトウェアはMITライセンスにより提供されています。  
詳細は「LICENSE.txt」をご覧ください。  

## パッケージ ##

本ソフトウェアは以下のNuGetパッケージを使用しています。  

| パッケージ                   | ライセンス                                                                                     |
|:-----------------------------|:-----------------------------------------------------------------------------------------------|
| WindowsAPICodePack-Core      | [Custom](https://github.com/aybe/Windows-API-Code-Pack-1.1/blob/master/LICENCE)                |
| WindowsAPICodePack-Shell     | [Custom](https://github.com/aybe/Windows-API-Code-Pack-1.1/blob/master/LICENCE)                |
| MahApps.Metro                | [MIT](https://github.com/MahApps/MahApps.Metro/blob/develop/LICENSE)                           |
| MahApps.Metro.IconPacks      | [MIT](https://github.com/MahApps/MahApps.Metro.IconPacks/blob/develop/LICENSE)                 |
| ControlzEx                   | [MIT](https://github.com/ControlzEx/ControlzEx/blob/develop/LICENSE)                           |
| Microsoft.Xaml.Behaviors.Wpf | [MIT](https://github.com/microsoft/XamlBehaviorsWpf/blob/master/LICENSE)                       |
| System.Text.Json             | [MIT](https://www.nuget.org/packages/System.Text.Json/4.7.2/license)                           |
| MaterialDesignThemes         | [MIT](https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit/blob/master/LICENSE) |
| MaterialDesignColors         | [MIT](https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit/blob/master/LICENSE) |
| MaterialDesignThemes.MahApps | [MIT](https://github.com/MaterialDesignInXAML/MaterialDesignInXamlToolkit/blob/master/LICENSE) |

また、本ソフトウェアが使用する**FFmpeg**は*LGPLv2.1*以降のライセンスとなっていますが、オプションのライブラリには*GPLv2*に準拠するライセンスが適用されるものもあります。  
詳細は[**FFmpeg**のライセンスのページ](https://www.ffmpeg.org/legal.html)を確認してください。

## 使用方法 ##

### Addボタン ###

Addボタンをクリックするとファイル選択ダイアログが表示されます。

変換するファイルを選択してください。

リストにコピーするファイルが表示されます。

なお追加できるファイルの種類については、**FFmpeg**の入力に使用できるファイルの種類からは絞っています。

- Video: ".mp4", ".asf", ".avi", ".swf", ".flv", ".mkv", ".mov", ".ogv", ".ogg", ".ogx", ".ts", ".webm"
- Audio: ".aac", ".ac3", ".adpcm", ".amr", ".alac", ".fla", ".flac", ".mp1", ".mp2", ".mp3", ".m4a", ".als", ".pcm", ".qcp", ".ra", ".oga", ".wma"

また、ファイルをドラッグアンドドロップする事でリストにファイルを追加する事もできます。

### Deleteボタン ###

リスト上のファイル名を選択後にDeleteボタンをクリックする事で、選択したファイル名をリストから除外する事ができます。

一旦除外したファイル名は元に戻す事はできません。  
元に戻すには再度Addボタンで変換元ファイルを選択して下さい。

### Clearボタン ###

リスト上のファイル名を全てリストから除外します。

一旦除外したファイル名は元に戻す事はできません。  
元に戻すには再度Addボタンで変換元ファイルを選択して下さい。

### Upボタン / Downボタン ###

リスト上のファイル名を選択後、UpボタンとDownボタンで変換するファイルのリスト上の順番を変える事ができます。

リスト上の順番を変える事で、ファイルを結合する場合の順番を変更する事ができます。  
個別に変換する場合には変換の順番が変わるだけで、あまり影響はありません。

### Convボタン ###

Convボタンをクリックするとリストに表示された全てのファイルの変換が開始されます。

変換するファイルのサイズ等が大きい場合には時間が掛かる場合があります。

ファイルの変換中はコンソール上に**FFmpeg**からの情報表示されます。  
ファイルの変換を中断したい場合にはコンソール右上の"閉じる"ボタンをクリックか<kbd>q</kbd>キーを押す等してコンソールを閉じてください。

変換完了後には使用した引数の一覧が表示されます。

#### Copyボタン ####

使用した引数の一覧をクリップボードにコピーします。

### Playボタン ###

リスト上のファイル名を選択後にPlayボタンをクリックすると、選択したファイルが再生されます。

再生には"ffplay"コマンドを使用しています。  
スキップや停止等の再生時の操作については"ffplay"と同じとなります。

再生を途中で終了したい場合には<kbd>q</kbd>や<kbd>ESC</kbd>キーを押すか、再生ウィンドウの右上の"閉じる"ボタンをクリックする等して再生ウィンドウを閉じてください。

### Infoボタン ###

リスト上のファイル名を選択後にInfoボタンをクリックすると、選択したファイルの情報が表示されます。

### Individual/Joinラジオボタン

- Individual: リストに表示されたファイルを個別に変換します。
- Join: リストに表示されたファイルを全て結合して変換します。

### Toボタン ###

Toボタンをクリックするとフォルダ選択ダイアログが表示されます。

変換後のファイルを保存する先のフォルダを選択してください。

フォルダを選択しない場合には変換後のファイルは変換元のファイルと同じフォルダに保存されます。

### ClearDirボタン ###

変換後のファイルを保存する先のフォルダをクリアします。

### Video/Audioラジオボタン ###

変換先のファイルタイプを選択します。

拡張子に表示されるファイルタイプが変わります。

### 拡張子 ###

変換先のファイルタイプを拡張子で選択します。

選択肢はVideo/Audioラジオボタンによって変わります。

### VideoOptionsボタン ###

ビデオエンコーダーのオプションを指定します。  
クリックによりダイアログボックスが表示されます。

変換先の拡張子を変更すると、内容がクリアされる場合があります。

#### ハードウェアデコーダーを試すチェックボックス ####

チェックをすると、ビデオの変換でデコードが必要となる場合、できるだけハードウェアデコーダーを使用します。

使用するハードウェアは自動的に選択されます。

**FFmpeg**のドキュメントによると、ハードウェアデコーダーはソフトウェアデコーダーと比べて遅くなる場合が多いとの事なので推奨しません。

#### 可能ならば変換せずにコピーチェックボックス ####

チェックをすると、エンコーダーの指定が変換元のビデオの諸元と変更がない場合には、ビデオをそのままコピーします。

#### エンコーダー指定チェックボックス ####

選択できるエンコーダーが複数存在する場合にチェックできるようになります。

チェックをすると、エンコーダーを選択できるようになります。

#### エンコーダー選択コンボボックス

エンコーダーを選択します。

選択するエンコーダーによってはエラーが発生したり画質が極端に悪くなったりします。

#### フレームレート指定チェックボックス ####

チェックをすると、フレームレートを選択する事ができるようになります。

#### フレームレート選択コンボボックス ####

フレームレートを選択します。

選択するフレームレートが変換元のビデオのフレームレートと異なる場合、フレームの補間が発生します。

なおフレームの補間は一番近いフレームをコピーする事で行われます。

#### 画像サイズ指定チェックボックス ####

チェックをすると、画像サイズを選択する事ができるようになります。

#### 画像サイズ選択コンボボックス ####

画像サイズを選択します。

選択する画像サイズが変換元のビデオの画像サイズと異なる場合には拡大、縮小が行われます。

拡大、縮小に使われるアルゴリズムは**FFmpeg**により自動的に選択されます。

#### アスペクト比指定チェックボックス ####

チェックをすると、画像サイズを選択する事ができるようになります。

#### アスペクト比選択コンボボックス ####

アスペクト比を選択します。

選択するアスペクト比が変換元のビデオのアスペクト比と異なる場合には画像が歪む場合があります。

#### 画質設定ラジオボタン ####

画質について、ビットレートを優先するか画質を優先するかの選択ができます。

- デフォルト: 基本的に画質やビットレートの設定を行わず、エンコーダーのデフォルト設定に任せます。
- ビットレート優先: ビデオのビットレートの指定をする事ができるようになります。
- 画質優先: 基本的にエンコーダーのデフォルト設定よりも高画質な設定が行われます。  
なおエンコーダーによりデフォルトと同じ設定になる場合があります。

#### 平均ビットレート ####

平均ビットレートの指定をテキストボックスに直接書き込むか、スライダーで設定します。

設定できる範囲は1Mbps～300Mbpsで、整数により指定します。

#### 最大ビットレート ####

最大ビットレートの指定をテキストボックスに直接書き込むか、スライダーで設定します。

設定できる範囲は平均ビットレート～300Mbpsで、整数により指定します。

平均ビットレートと同じ値か近い値を指定した場合にはCBRとなります。

### AudioOptionsボタン ###

オーディオエンコーダーのオプションを指定します。  
クリックによりダイアログボックスが表示されます。

変換先の拡張子を変更すると、内容がクリアされる場合があります。

#### 可能ならば変換せずにコピーチェックボックス ####

チェックをすると、エンコーダーの指定が変換元のオーディオの諸元と変更がない場合には、オーディオをそのままコピーします。

#### エンコーダー指定チェックボックス ####

選択できるエンコーダーが複数存在する場合にチェックできるようになります。

チェックをすると、エンコーダーを選択できるようになります。

#### エンコーダー選択コンボボックス

エンコーダーを選択します。

選択するエンコーダーによってはエラーが発生したり音質が極端に悪くなったりします。

#### チャンネル指定ラジオボタン ####

デフォルト、モノラル、ステレオの3つから選択します。

- デフォルト: 変換元のオーディオと同じチャンネル構成となります。
- モノラル: 強制的にモノラルとします。
- ステレオ: 強制的にステレオとします。

#### サンプリングレート指定チェックボックス ####

チェックをすると、サンプリングレートを選択する事ができるようになります。

#### サンプリングレート選択コンボボックス ####

サンプリングレートを選択します。

選択するサンプリングレートが変換元のオーディオのサンプリングレートと異なる場合には変換が行われます。

変換に使われるアルゴリズムは**FFmpeg**により自動的に選択されます。

#### ビットレート指定チェックボックス ####

チャンネル数とサンプリングレートから自動的にビットレートが決まらないオーディオコーデックが選択された場合に有効となります。

チェックをすると、ビットレートを選択する事ができるようになります。

#### ビットレート選択コンボボックス ####

ビットレートを選択します。

選択するビットレートが変換元のオーディオのビットレートと異なる場合には音質が悪くなる場合があります。

### Additional Optionsテキストボックス ###

追加のオプションを記入します。

追加のオプションは出力ファイル名の直前に挿入されます。

オプションによっては変換時にエラー発生の要因になる場合があります。  
追加のオプションを使用する場合には十分な検討をお願いします。

### Exitボタン ###

アプリケーションを終了します。

## 変更履歴 ##

### 2.1.0 ###

- 追加のオプションを指定できる欄を追加。
- ビデオのエンコードオプションで画質優先の設定追加。

### 2.0.0 ###

ビデオとオーディオのオプションの引数の内の幾つかについて指定できるように機能を追加。

### 1.2.0 ###

- ファイル情報については**FFprobe**の出力から必要な情報のみを取り出して表示するようにした。
- オーディオのビットレートについては、変換元のオーディオのビットレートをそのまま使用するようにした。

### 1.1.0 ###

ドラッグアンドドロップでファイルを追加できるように機能を追加。

### 1.0.0 ###

とりあえずファイルの変換をできるようにした。
